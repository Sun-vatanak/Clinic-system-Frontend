{
  "version": 3,
  "sources": ["../../tom-select/src/utils.ts"],
  "sourcesContent": ["\r\nimport type TomSelect from './tom-select.ts';\r\nimport { TomLoadCallback } from './types/index.ts';\r\n\r\n\r\n/**\r\n * Converts a scalar to its best string representation\r\n * for hash keys and HTML attribute values.\r\n *\r\n * Transformations:\r\n *   'str'     -> 'str'\r\n *   null      -> ''\r\n *   undefined -> ''\r\n *   true      -> '1'\r\n *   false     -> '0'\r\n *   0         -> '0'\r\n *   1         -> '1'\r\n *\r\n */\r\nexport const hash_key = (value:undefined|null|boolean|string|number):string|null => {\r\n\tif (typeof value === 'undefined' || value === null) return null;\r\n\treturn get_hash(value);\r\n};\r\n\r\nexport const get_hash = (value:boolean|string|number):string => {\r\n\tif (typeof value === 'boolean') return value ? '1' : '0';\r\n\treturn value + '';\r\n};\r\n\r\n/**\r\n * Escapes a string for use within HTML.\r\n *\r\n */\r\nexport const escape_html = (str:string):string => {\r\n\treturn (str + '')\r\n\t\t.replace(/&/g, '&amp;')\r\n\t\t.replace(/</g, '&lt;')\r\n\t\t.replace(/>/g, '&gt;')\r\n\t\t.replace(/\"/g, '&quot;');\r\n};\r\n\r\n\r\n/**\r\n * use setTimeout if timeout > 0 \r\n */\r\nexport const timeout = (fn:()=>void,timeout:number): number | null => {\r\n\tif( timeout > 0 ){\r\n\t\treturn window.setTimeout(fn,timeout);\r\n\t}\r\n\r\n\tfn.call(null);\r\n\treturn null;\r\n}\r\n\r\n/**\r\n * Debounce the user provided load function\r\n *\r\n */\r\nexport const loadDebounce = (fn:(value:string,callback:TomLoadCallback) => void,delay:number) => {\r\n\tvar timeout: null|ReturnType<typeof setTimeout>;\r\n\treturn function(this:TomSelect, value:string,callback:TomLoadCallback) {\r\n\t\tvar self = this;\r\n\r\n\t\tif( timeout ){\r\n\t\t\tself.loading = Math.max(self.loading - 1, 0);\r\n\t\t\tclearTimeout(timeout);\r\n\t\t}\r\n\t\ttimeout = setTimeout(function() {\r\n\t\t\ttimeout = null;\r\n\t\t\tself.loadedSearches[value] = true;\r\n\t\t\tfn.call(self, value, callback);\r\n\r\n\t\t}, delay);\r\n\t};\r\n};\r\n\r\n\r\n/**\r\n * Debounce all fired events types listed in `types`\r\n * while executing the provided `fn`.\r\n *\r\n */\r\nexport const debounce_events = ( self:TomSelect, types:string[], fn:() => void ) => {\r\n\tvar type:string;\r\n\tvar trigger = self.trigger;\r\n\tvar event_args:{ [key: string]: any } = {};\r\n\r\n\t// override trigger method\r\n\tself.trigger = function(){\r\n\t\tvar type = arguments[0];\r\n\t\tif (types.indexOf(type) !== -1) {\r\n\t\t\tevent_args[type] = arguments;\r\n\t\t} else {\r\n\t\t\treturn trigger.apply(self, arguments);\r\n\t\t}\r\n\t};\r\n\r\n\t// invoke provided function\r\n\tfn.apply(self, []);\r\n\tself.trigger = trigger;\r\n\r\n\t// trigger queued events\r\n\tfor( type of types ){\r\n\t\tif( type in event_args ){\r\n\t\t\ttrigger.apply(self, event_args[type]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\n/**\r\n * Determines the current selection within a text input control.\r\n * Returns an object containing:\r\n *   - start\r\n *   - length\r\n *\r\n * Note: \"selectionStart, selectionEnd ... apply only to inputs of types text, search, URL, tel and password\"\r\n * \t- https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange\r\n */\r\nexport const getSelection = (input:HTMLInputElement):{ start: number; length: number } => {\r\n\treturn {\r\n\t\tstart\t: input.selectionStart || 0,\r\n\t\tlength\t: (input.selectionEnd||0) - (input.selectionStart||0),\r\n\t};\r\n};\r\n\r\n\r\n/**\r\n * Prevent default\r\n *\r\n */\r\nexport const preventDefault = (evt?:Event, stop:boolean=false):void => {\r\n\tif( evt ){\r\n\t\tevt.preventDefault();\r\n\t\tif( stop ){\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Add event helper\r\n *\r\n */\r\nexport const addEvent = (target:EventTarget, type:string, callback:EventListenerOrEventListenerObject, options?:object):void => {\r\n\ttarget.addEventListener(type,callback,options);\r\n};\r\n\r\n\r\n/**\r\n * Return true if the requested key is down\r\n * Will return false if more than one control character is pressed ( when [ctrl+shift+a] != [ctrl+a] )\r\n * The current evt may not always set ( eg calling advanceSelection() )\r\n *\r\n */\r\nexport const isKeyDown = ( key_name:keyof (KeyboardEvent|MouseEvent), evt?:KeyboardEvent|MouseEvent ) => {\r\n\r\n\tif( !evt ){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif( !evt[key_name] ){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar count = (evt.altKey?1:0) + (evt.ctrlKey?1:0) + (evt.shiftKey?1:0) + (evt.metaKey?1:0);\r\n\r\n\tif( count === 1 ){\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\n\r\n/**\r\n * Get the id of an element\r\n * If the id attribute is not set, set the attribute with the given id\r\n *\r\n */\r\nexport const getId = (el:Element,id:string) => {\r\n\tconst existing_id = el.getAttribute('id');\r\n\tif( existing_id ){\r\n\t\treturn existing_id;\r\n\t}\r\n\r\n\tel.setAttribute('id',id);\r\n\treturn id;\r\n};\r\n\r\n\r\n/**\r\n * Returns a string with backslashes added before characters that need to be escaped.\r\n */\r\nexport const addSlashes = (str:string):string => {\r\n\treturn str.replace(/[\\\\\"']/g, '\\\\$&');\r\n};\r\n\r\n/**\r\n *\r\n */\r\nexport const append = ( parent:Element|DocumentFragment, node: string|Node|null|undefined ):void =>{\r\n\tif( node ) parent.append(node);\r\n};\r\n\r\n/**\r\n * Iterates over arrays and hashes.\r\n *\r\n * ```\r\n * iterate(this.items, function(item, id) {\r\n *    // invoked for each item\r\n * });\r\n * ```\r\n *\r\n */\r\nexport const iterate = (object:[]|{[key:string]:any}, callback:(value:any,key:any)=>any) => {\r\n\r\n\tif ( Array.isArray(object)) {\r\n\t\tobject.forEach(callback);\r\n\r\n\t}else{\r\n\r\n\t\tfor (var key in object) {\r\n\t\t\tif (object.hasOwnProperty(key)) {\r\n\t\t\t\tcallback(object[key], key);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n"],
  "mappings": "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",
  "names": ["timeout", "type"]
}
